# LiveBikeRide
ライブバイクライドと読みます。BKB的な。

# 概要
これはアバターがバイクに乗っている様子を表示するアプリです。

# 使用方法
アプリ起動後、VRMファイルを読み込んでOBSなどのストリーミングソフトで映像入力する

VRMファイルの読み込みは、ファイルブラウザもしくは、ファイルをアプリ画面にドラッグ・アンド・ドロップすることで行う。

アプリ内のUIを含めてストリーミングソフトに表示する場合はゲームキャプチャ、
アバター及びバイクのモデルのみを表示する場合は映像キャプチャデバイスを使用して映像を入力する


# 環境
## 開発
* Unity 2020.3.28f1
* その他特記すべき項目があれば随時更新

## 使用パッケージやアセット等
以下のパッケージやアセットはプロジェクトファイルに同梱しないので、各自インポートしてください。
* [UniTask 2.3.1](https://github.com/Cysharp/UniTask)
    - 非同期処理に使用
    - このアプリの開発を通してasync/await+UniTaskの習得を目標とする
* [UniRx 7.1.0](https://github.com/neuecc/UniRx)
    - イベント処理に使用
    - MV(R)Pパターンで実装するために使用（UniTaskを使用するのが相応しくない場面で使用？）
* [UniVRM v0.97.0](https://github.com/vrm-c/UniVRM)
    - VRMファイルのランタイムロードをサポートするために使用
* [UnityCapture](https://github.com/schellingb/UnityCapture)
    - アプリ内のキャラクターを写すカメラを仮想ウェブカメラとし、映像出力するために使用
    - ユーザが仮想カメラを使用する際は、リンク先のInstallationの項目を参照し、UnityCaptureをインストールする
* [OpenCV for Unity 2.4.7](https://assetstore.unity.com/packages/tools/integration/opencv-for-unity-21088?locale=ja-JP)
    - ウェブカメラからの映像入力し、その映像から顔の位置及びロール角を認識を行い、アバターおよびバイクの状態に反映するために使用
* [FinalIK ver 2.1](https://assetstore.unity.com/packages/tools/animation/final-ik-14290)
    - アバターの手や腰や膝、足の位置などを調整する機能を実装するために使用

* [オリジナル3Dモデル　Rgray【アルグレイ】 及びベルガモッド ©紅茶のお店](https://booth.pm/ja/items/1935911)
    - 配布アプリに組み込む予定のデフォルトのアバター及びバイク
    - [利用規約 ver 1.00](https://drive.google.com/file/d/1b5KY83wFXVeUsYrBiNEaYOse7c0y_G2o/view) =>個別条件-8ページ (6)メディア・プロダクトへの利用-R「製品開発などのためにソフトウェア（ゲームを含みます）への組み込み、容易に取り出せない状態にして配布すること => 権利者に個別に問い合わせて下さい。」とのことなので、権利者様に問い合わせ後、許可を得た後にアプリ配布開始
* その他設計段階で使用パッケージ、使用アセットが増えた場合に随時更新

# 機能
実装しつつ追記していきます。
## VRMランタイムロード
* タイトル画面にて、アバターのランタイムロードを行う
## 位置調整
* メイン画面にて、アバターの手や足の位置を調整する
## スケール調整
* メイン画面にて、バイクのスケールを調整する
## アバター及びバイクの挙動
* メイン画面にて、ウェブカメラから入力された映像をもとに顔の位置と向きを推定
* 推定された顔の位置と向きから、表示されているアバターの顔の向きやバイクの傾きなどに反映
* どれくらい反映するかは調整可能とする
## 映像出力
* タイトル画面及びメイン画面にて、仮想カメラとしてアプリの映像を出力する

# プロジェクトファイルについて
## バイクモデルの扱い
* オブジェクトの中心が下図のようになっているものを用意して下さい。
* （画像を作成後追加します。メモ→左右のハンドルの端から端の中心がX0、タイヤ接地面がY0、ホイールベースの半分の位置（フロントタイヤの中心からリアタイヤの中心の真ん中）がZ0）
* オブジェクトの向きが下図のようになっているものを用意して下さい。
* （画像を作成ご追加します。メモ→クラッチペダル側が―X、ブレーキペダル側が＋X、フロントタイヤ側が＋Z、リアタイヤ側が―Z、バイクが起きている状態の空側がY+、地面側がY-）
* スケールについてはアプリ内の機能で調整できるようにします。
* ハンドル（グリップ）の位置やシートの位置、ペダルの位置などは、それぞれのバイクの構造で違う上、それらの位置は3DCG内のオブジェクトの構造から読み取ることが不可能なため、アプリ内の機能でアバターの手や腰や膝、足の位置を調整できるようにします。
* 実装の優先度は低いですが、今後ランタイムロードを実装する構想があります。
* プロジェクトファイルをダウンロードしてバイクのファイルをシーン内に配置する場合は、シーンに配置した後に、Inspectorを利用して以下のコンポーネントの項目にアタッチして下さい。（画像を作成後追加します。）

## アバターモデルの扱い
* ローカルのVRMファイルのランタイムロードをサポートします。


# その他
* 問い合わせ先→ [Twitter@Sunmax](https://twitter.com/Sunmax0731)